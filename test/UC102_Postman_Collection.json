{
  "info": {
    "name": "UC102 - Review and Feedback API",
    "description": "API tests for Review and Feedback feature",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080/api"
    },
    {
      "key": "token",
      "value": "your_jwt_token_here"
    },
    {
      "key": "company_id",
      "value": "1"
    },
    {
      "key": "request_id",
      "value": "1"
    }
  ],
  "item": [
    {
      "name": "1. Create/Update Review",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"requestId\": {{request_id}},\n  \"rating\": 5,\n  \"comment\": \"Tới nhanh, xử lý chuyên nghiệp.\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/reviews",
          "host": ["{{base_url}}", "reviews"],
          "port": "8080"
        },
        "description": "Create or update a review for a rescue request (UC102)"
      },
      "response": []
    },
    {
      "name": "2. Get Company Reviews (Paginated)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/reviews/companies/{{company_id}}/reviews?page=1&limit=10",
          "host": ["{{base_url}}"],
          "path": ["reviews", "companies", "{{company_id}}", "reviews"],
          "query": [
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "limit",
              "value": "10"
            }
          ]
        },
        "description": "Get paginated reviews for a specific company"
      },
      "response": []
    },
    {
      "name": "3. Get Company Average Rating",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/reviews/companies/{{company_id}}/rating",
          "host": ["{{base_url}}", "reviews", "companies", "{{company_id}}", "rating"]
        },
        "description": "Get the average rating for a company"
      },
      "response": []
    },
    {
      "name": "4. Get My Reviews",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}"
          }
        ],
        "url": {
          "raw": "{{base_url}}/reviews/my-reviews",
          "host": ["{{base_url}}", "reviews", "my-reviews"]
        },
        "description": "Get all reviews submitted by current user"
      },
      "response": []
    },
    {
      "name": "5. Check If User Reviewed",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}"
          }
        ],
        "url": {
          "raw": "{{base_url}}/reviews/check?companyId={{company_id}}",
          "host": ["{{base_url}}", "reviews", "check"],
          "query": [
            {
              "key": "companyId",
              "value": "{{company_id}}"
            }
          ]
        },
        "description": "Check if current user has already reviewed a company"
      },
      "response": []
    },
    {
      "name": "Error Cases - Invalid Rating",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"requestId\": {{request_id}},\n  \"rating\": 10,\n  \"comment\": \"Invalid rating\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/reviews",
          "host": ["{{base_url}}", "reviews"]
        },
        "description": "Test error handling: rating must be 1-5"
      },
      "response": []
    },
    {
      "name": "Error Cases - Missing Required Field",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"rating\": 5,\n  \"comment\": \"Missing requestId\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/reviews",
          "host": ["{{base_url}}", "reviews"]
        },
        "description": "Test error handling: requestId is required"
      },
      "response": []
    },
    {
      "name": "Error Cases - Unauthorized",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer invalid_token"
          }
        ],
        "url": {
          "raw": "{{base_url}}/reviews/my-reviews",
          "host": ["{{base_url}}", "reviews", "my-reviews"]
        },
        "description": "Test error handling: invalid token"
      },
      "response": []
    }
  ]
}
